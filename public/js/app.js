/**
* app.js
*
* Main app mojo client
* Requires
*   jQuery
*   Bootstrap
*   Darkroom image editor
*   Ace code editor
*   TreeViews
*   Able
*/

jQuery(function($) { // it's jQuery compatible
  
/** Main behaviors */

/* Menus */

/* file */

/* file -> new */
$("#menu-file-new").click(function(e){
    console.log("Implement it!", e);
});
/* file -> open */
$("#menu-file-open").click(function(e){
    console.log("Implement it!", e);
});
/* file -> save */
$("#menu-file-save").click(function(e){
    console.log("Implement it!", e);
});
/* file -> save as */
$("#menu-file-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* file -> history  */
$("#menu-file-history").click(function(e){
    console.log("Implement it!", e);
});
/* file -> github */
$("#menu-file-github").click(function(e){
    console.log("Implement it!", e);
});


/* articles */

/* article -> new */
$("#menu-article-new").click(function(e){
    console.log("Implement it!", e);
});
/* article -> open */
$("#menu-article-open").click(function(e){
    console.log("Implement it!", e);
});
/* article -> save */
$("#menu-article-save").click(function(e){
    console.log("Implement it!", e);
});
/* article -> save as */
$("#menu-article-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* article -> history  */
$("#menu-article-history").click(function(e){
    console.log("Implement it!", e);
});
/* article -> github */
$("#menu-article-github").click(function(e){
    console.log("Implement it!", e);
});

/* menus */

/* menu -> new */
$("#menu-menu-new").click(function(e){
    console.log("Implement it!", e);
});
/* menu -> open */
$("#menu-menu-open").click(function(e){
    console.log("Implement it!", e);
});
/* menu -> save */
$("#menu-menu-save").click(function(e){
    console.log("Implement it!", e);
});
/* menu -> save as */
$("#menu-menu-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* menu -> history  */
$("#menu-menu-history").click(function(e){
    console.log("Implement it!", e);
});
/* menu -> github */
$("#menu-menu-github").click(function(e){
    console.log("Implement it!", e);
});


/* themes */

/* theme -> new */
$("#menu-theme-new").click(function(e){
    console.log("Implement it!", e);
});
/* theme -> open */
$("#menu-theme-open").click(function(e){
    console.log("Implement it!", e);
});
/* theme -> save */
$("#menu-theme-save").click(function(e){
    console.log("Implement it!", e);
});
/* theme -> save as */
$("#menu-theme-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* theme -> history  */
$("#menu-theme-history").click(function(e){
    console.log("Implement it!", e);
});
/* theme -> github */
$("#menu-theme-github").click(function(e){
    console.log("Implement it!", e);
});


/* templates */

/* template -> new */
$("#menu-template-new").click(function(e){
    console.log("Implement it!", e);
});
/* template -> open */
$("#menu-template-open").click(function(e){
    console.log("Implement it!", e);
});
/* template -> save */
$("#menu-template-save").click(function(e){
    console.log("Implement it!", e);
});
/* template -> save as */
$("#menu-template-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* template -> history  */
$("#menu-template-history").click(function(e){
    console.log("Implement it!", e);
});
/* template -> github */
$("#menu-template-github").click(function(e){
    console.log("Implement it!", e);
});


/* media  */

/* media -> new */
$("#menu-media-new").click(function(e){
    console.log("Implement it!", e);
});
/* media -> open */
$("#menu-media-open").click(function(e){
    console.log("Implement it!", e);
});
/* media -> save */
$("#menu-media-save").click(function(e){
    console.log("Implement it!", e);
});
/* media -> save as */
$("#menu-media-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* media -> history  */
$("#menu-media-history").click(function(e){
    console.log("Implement it!", e);
});
/* media -> github */
$("#menu-media-github").click(function(e){
    console.log("Implement it!", e);
});

/* format */

/* format -> new */
$("#menu-format-new").click(function(e){
    console.log("Implement it!", e);
});
/* format -> open */
$("#menu-format-open").click(function(e){
    console.log("Implement it!", e);
});
/* format -> save */
$("#menu-format-save").click(function(e){
    console.log("Implement it!", e);
});
/* format -> save as */
$("#menu-format-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* format -> history  */
$("#menu-format-history").click(function(e){
    console.log("Implement it!", e);
});
/* format -> github */
$("#menu-format-github").click(function(e){
    console.log("Implement it!", e);
});

/* behaviors */

/* behaviors -> new */
$("#menu-behaviors-new").click(function(e){
    console.log("Implement it!", e);
});
/* behaviors -> open */
$("#menu-behaviors-open").click(function(e){
    console.log("Implement it!", e);
});
/* behaviors -> save */
$("#menu-behaviors-save").click(function(e){
    console.log("Implement it!", e);
});
/* behaviors -> save as */
$("#menu-behaviors-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* behaviors -> history  */
$("#menu-behaviors-history").click(function(e){
    console.log("Implement it!", e);
});
/* behaviors -> github */
$("#menu-behaviors-github").click(function(e){
    console.log("Implement it!", e);
});

/* view */

/* view -> new */
$("#menu-view-new").click(function(e){
    console.log("Implement it!", e);
});
/* view -> open */
$("#menu-view-open").click(function(e){
    console.log("Implement it!", e);
});
/* view -> save */
$("#menu-view-save").click(function(e){
    console.log("Implement it!", e);
});
/* view -> save as */
$("#menu-view-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* view -> history  */
$("#menu-view-history").click(function(e){
    console.log("Implement it!", e);
});
/* view -> bash  */
$("#menu-view-bash").click(function(e){
    $("div#view-canvas iframe").attr( 'src', "http://localhost:60606");
});
/* view -> github */
$("#menu-view-github").click(function(e){
    console.log("Implement it!", e);
});


/* tasks */

/* task -> new */
$("#menu-task-new").click(function(e){
    console.log("Implement it!", e);
});
/* task -> open */
$("#menu-task-open").click(function(e){
    console.log("Implement it!", e);
});
/* task -> save */
$("#menu-task-save").click(function(e){
    console.log("Implement it!", e);
});
/* task -> save as */
$("#menu-task-saveas").click(function(e){
    console.log("Implement it!", e);
});
/* task -> history  */
$("#menu-task-history").click(function(e){
    console.log("Implement it!", e);
});
/* task -> github */
$("#menu-task-github").click(function(e){
    console.log("Implement it!", e);
});









/* Modals */
$("#modalFileChooser").on('show.bs.modal', function(e){
    console.log("Implement tis modal!", e);
		var $button = $(e.relatedTarget) // Button that triggered the modal
    var msg = $button.data('whatever');
		let command = $button.data('command');
		let path = $button.data('path');
    switch (command) {
      case 'loadDir':
        loadDir(path, function(d){
				   console.log("Received ", d);


$('#fileTreeView').treeview({
  data: d,
  levels: 5,
  /* backColor: '#211e1e' */
});


					 return 1;
				});
        break;
      case 'Mangoes':
      case 'Papayas':
        console.log('Mangoes and papayas are $2.79 a pound.');
        // expected output: "Mangoes and papayas are $2.79 a pound."
        break;
      default:
        console.log('Sorry, we are out of ' + command + '.');
    }
	  console.log(msg);
});

$("#darkroomPopup").on('show.bs.modal', function(e){
    console.log("Implement tis modal!", e);
		var $button = $(e.relatedTarget) // Button that triggered the modal
    var msg = $button.data('whatever');
	  console.log(msg);
});


/** Ajax features 
 *  Require jQuery
 * */

/* Load directory */
function loadDir(path, c){
   let j = { command:'loaddir', path:path };
	 $.ajax({
	    type: 'POST',
	    dataType: "json",
      url: "/json",
			data: JSON.stringify(j),
			contentType: 'application/json; charset=utf-8',
   })
  .done(function( data ) {
    if ( console && console.log ) {
      //console.log( "Sample of data:", data.slice( 0, 100 ) );
      console.log( "url:", this.url );
      console.log( "Sample of data:", data );
    }
		if ( typeof(c) == 'function') c(data)
  });
   return path;
}


/** The Darkroom image editor */
/*
    var dkrm = new Darkroom('#target', {
      // Size options
      minWidth: 100,
      minHeight: 100,
      maxWidth: 600,
      maxHeight: 200,
      ratio: 4/3,
      backgroundColor: '#000',

      // Plugins options
      plugins: {
        //save: false,
        crop: {
          quickCropKey: 67, //key "c"
          //minHeight: 50,
          //minWidth: 50,
          //ratio: 4/3
        }
      },

      // Post initialize script
      initialize: function() {
        var cropPlugin = this.plugins['crop'];
        // cropPlugin.selectZone(170, 25, 300, 300);
        cropPlugin.requireFocus();
      }
    });
 
*/

 var dkrm =  new Darkroom('#target', {
  // Canvas initialization size
  minWidth: 100,
  minHeight: 100,
  maxWidth: 600,
  maxHeight: 300,
	ratio: 1,

  // Plugins options
  plugins: {
    crop: {
          quickCropKey: 67, //key "c"
      minHeight: 50,
      minWidth: 50,
      ratio: 1
    },
    // save: false // disable plugin
  },

  // Post initialization method
  initialize: function() {
    // Active crop selection
    this.plugins['crop'].requireFocus();

    // Add custom listener
    this.addEventListener('core:transformation', function() { /* ... */ });
  }
});


/* The file tree */
var tree = [
  {
    text: "img",
		icon: "glyphicon glyphicon-folder-close",
		selectedIcon: "glyphicon glyphicon-folder-close",
		backColor: "#FFFFFF",
		state: {
      checked: false,
      disabled: false,
      expanded: false,
      selected: false
    },
    nodes: [
      {
        text: "Child 1",
        nodes: [
          {
            text: "Grandchild 1"
          },
          {
            text: "Grandchild 2"
          }
        ]
      },
      {
        text: "Child 2"
      }
    ]
  },
  {
    text: "Parent 2"
  },
  {
    text: "Parent 3"
  },
  {
    text: "Parent 4"
  },
  {
    text: "Parent 5"
  }
];

function getProjectFiles (theThing){
  console.log(theThing);

}

$('#fileTreeView').treeview({
  data: tree,         // data is not optional
  levels: 5,
  /* backColor: '#211e1e' */
});


}); // closes jQuery ready function

